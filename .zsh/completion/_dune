#compdef dune

_dune () {
  local -a commands
  commands=(
    'build:Build the given targets, or all installable targets if none are given.'
    'clean:Clean the project.'
    'exec:Execute a command in a similar environment as if installation was performed.'
    'external-lib-deps:Print out external libraries needed to build the given targets.'
    'format-dune-file:Format dune files'
    'init:Initialize dune components.'
    'install:Install packages.'
    'installed-libraries:Print out libraries installed on the system.'
    'printenv:Print the environment of a directory.'
    'promote:Promote files from the last run.'
    'rules:Dump internal rules.'
    'runtest:Run tests.'
    'uninstall:Uninstall packages.'
    'utop:Load library in utop.'
    'help:Additional Dune help.'
  )

  if (( CURRENT == 2 )); then
    _describe -t commands 'commands' commands
  fi

  return 0
}

compdef _dune dune
